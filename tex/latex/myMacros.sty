\ProvidesPackage{myMacros}
\author{Jialin Xin}

\RequirePackage{xparse}

\RequirePackage{amsmath,amssymb,mathrsfs}
\RequirePackage{mathtools}
% \RequirePackage{etoolbox}

% symbols
\newcommand{\RR}{\mathbb{R}}
\newcommand{\CC}{\mathbb{C}}
\newcommand{\HH}{\mathbb{H}}
\newcommand{\OO}{\mathbb{O}}
\newcommand{\const}{\mathrm{const.}}

% operators
\renewcommand{\Re}{\operatorname{Re}}
\renewcommand{\Im}{\operatorname{Im}}
\DeclareMathOperator{\tr}{tr}
\DeclareMathOperator{\End}{End}
\DeclareMathOperator{\Hom}{Hom}

% extensible equal sign
% usage: \xeq[below]{above}
\newcommand*{\Relbarfill@}{\arrowfill@\Relbar\Relbar\Relbar}
\newcommand*{\xeq}[2][]{\ext@arrow 0055\Relbarfill@{#1}{#2}}

% for function restriction, differentiation at a point, etc.
\newcommand{\at}[2]{%
  {\left.\kern-\nulldelimiterspace#1\right|_{#2}}%
}

% differential symbols
\newcommand*{\Diff}[2]{\frac{d#1}{d#2}}
\newcommand*{\DiffAt}[3]{%
  \at{\Diff{#1}{#2}}{#3}%
}

% usage: \partialD{order}{function}{variable1,variable2,...}
\newcommand*{\partialD}[3]{%
  \frac{\partial^{#1}#2}{%
    \@for\item:=#3\do{\partial\item}%
  }%
}


% By default, the subscript will be too high if it is a capital letter,
% adding an empty superscript can solve this.
\newcommand{\@emptySup}{\@ifnextchar^{}{^{}}}

% absolute value
\DeclarePairedDelimiter\abs\lvert\rvert

% norm
\DeclarePairedDelimiter\norm\lVert\rVert
% \DeclarePairedDelimiterXPP\norm[2]{}\lVert\rVert{
%   \ifblank{#2}{}{_#2} }{% #2=space
%   \ifblank{#1}{\:\cdot\:}{#1}% #1=vector
% }

% inner product
% usage: \inn{x}{y}; \innerp{x}{y}{space}
\DeclarePairedDelimiterX\inn[2]\langle\rangle{#1,#2}
% TODO: rewrite using xparse
\DeclarePairedDelimiterXPP\@innerp[3]{}\langle\rangle{_{#3}}{#1,#2}
\newcommand*{\@innerpNoStar}[4][]{\@innerp[#1]{#2}{#3}{#4}\@emptySup}
\newcommand*{\@innerpStar}[3]{\@innerp*{#1}{#2}{#3}\@emptySup}
\newcommand*{\innerp}{\@ifstar{\@innerpStar}{\@innerpNoStar}}

% set definition (taken from the mathtools doc)
% usage: \Set{elements}, or \Set{elements \given conditions}
\providecommand\given{} % the vertical bar in set definitions
\newcommand\SetSymbol[1][]{%
  \mathchoice{\:}{\:}{\,}{\,}#1\vert
   \allowbreak
   \mathchoice{\:}{\:}{\,}{\,}
   \mathopen{}
}
\DeclarePairedDelimiterX\Set[1]\{\}{%
  \renewcommand\given{\SetSymbol[\delimsize]}%
  #1%
}

\endinput
